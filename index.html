<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Matemática</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Calculadora Matemática</h1>

        <!-- Límite con L'Hôpital -->
        <div class="card">
            <h2>Límites con L'Hôpital</h2>
            <p>Introduce las funciones f(x) y g(x) y el valor al que x tiende:</p>
            <label>f(x):</label>
            <input type="text" id="fx" placeholder="Ej: sin(x)">
            <label>g(x):</label>
            <input type="text" id="gx" placeholder="Ej: x">
            <label>Valor de x →</label>
            <input type="number" id="x0" placeholder="Ej: 0">
            <button onclick="calcularLHopital()">Calcular límite</button>
            <div id="resultado-lhopital" class="resultado"></div>
        </div>

        <!-- Derivadas generales -->
        <div class="card">
            <h2>Derivadas generales</h2>
            <p>Introduce la función f(x) que deseas derivar:</p>
            <label>f(x):</label>
            <input type="text" id="f-deriv" placeholder="Ej: x^3 + sin(x)">
            <button onclick="calcularDerivada()">Calcular derivada</button>
            <div id="resultado-derivada" class="resultado"></div>
        </div>

        <!-- Instrucciones -->
        <div class="card instructions">
            <h2>Cómo escribir las funciones (Math.js)</h2>
            <ul>
                <li><b>Potencias:</b> x^2, x^n</li>
                <li><b>Raíz cuadrada:</b> sqrt(x)</li>
                <li><b>Fracciones:</b> (x^2-1)/(x-1)</li>
                <li><b>Trigonometría:</b> sin(x), cos(x), tan(x)</li>
                <li><b>Logaritmos:</b> log(x) → natural, log10(x) → base 10, log(x, n) → base n</li>
                <li><b>Exponenciales:</b> exp(x) → e^x</li>
                <li><b>Ejemplo de L'Hôpital:</b> f(x) = sin(x), g(x) = x, x → 0</li>
                <li><b>Ejemplo de derivada:</b> f(x) = x^3 + sin(x) → f'(x) = 3x^2 + cos(x)</li>
            </ul>
        </div>
    </div>

    <!-- Scripts -->
    <script>
    // Límite con L'Hôpital
    function calcularLHopital() {
        let fx = document.getElementById("fx").value;
        let gx = document.getElementById("gx").value;
        let x0 = parseFloat(document.getElementById("x0").value);

        try {
            let fVal = math.evaluate(fx, {x: x0});
            let gVal = math.evaluate(gx, {x: x0});

            if (fVal === 0 && gVal === 0) {
                let fDer = math.derivative(fx, "x").toString();
                let gDer = math.derivative(gx, "x").toString();
                let fDerVal = math.evaluate(fDer, {x: x0});
                let gDerVal = math.evaluate(gDer, {x: x0});
                let resultado = fDerVal / gDerVal;

                let resDiv = document.getElementById("resultado-lhopital");
                resDiv.innerHTML =
                    `<b>Forma 0/0 detectada.</b><br>
                     f'(x) = ${fDer} <br>
                     g'(x) = ${gDer} <br>
                     Límite = ${resultado}`;
                resDiv.classList.add("mostrar");
            } else {
                let limite = fVal / gVal;
                let resDiv = document.getElementById("resultado-lhopital");
                resDiv.innerHTML = `No es indeterminada. Resultado directo = ${limite}`;
                resDiv.classList.add("mostrar");
            }
        } catch (error) {
            let resDiv = document.getElementById("resultado-lhopital");
            resDiv.innerHTML = "Error en la expresión. Revisa la sintaxis.";
            resDiv.classList.add("mostrar");
        }
    }

    // Derivadas generales
    function calcularDerivada() {
        let f = document.getElementById("f-deriv").value;

        try {
            let deriv = math.derivative(f, "x").toString();
            let resDiv = document.getElementById("resultado-derivada");
            resDiv.innerHTML = `f'(x) = ${deriv}`;
            resDiv.classList.add("mostrar");
        } catch (error) {
            let resDiv = document.getElementById("resultado-derivada");
            resDiv.innerHTML = "Error en la expresión. Revisa la sintaxis.";
            resDiv.classList.add("mostrar");
        }
    }
    </script>
</body>
</html>

